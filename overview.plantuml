@startuml

interface "MQTT" as mqttin
interface "MQTT" as mqttout
interface "Data File" as file
interface "Prometheus Client" as prom
interface "GET /state" as getstate
interface "GET /metrics" as getmetrics
component [Root State] as root
component [Rules] as rules

mqttin .right.> root
root .up.> file: backup
root -> rules: events
rules -> mqttout
rules .down.> prom: gauge
root .down.> getstate: current state
prom .down.> getstate: current state
prom .down.> getmetrics: current state

@enduml
